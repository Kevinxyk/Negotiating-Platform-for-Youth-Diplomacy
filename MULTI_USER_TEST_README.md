# å¤šç”¨æˆ·æµ‹è¯•æŒ‡å—

æœ¬æŒ‡å—å°†å¸®åŠ©ä½ åœ¨æœ¬åœ°æ–¹è¿è¡Œå¤šç”¨æˆ·æµ‹è¯•ï¼Œä»¥éªŒè¯ç³»ç»Ÿçš„å¹¶å‘æ€§èƒ½å’ŒåŠŸèƒ½ã€‚

## æµ‹è¯•æ–¹æ³•

### æ–¹æ³•1: ä½¿ç”¨Node.jsè„šæœ¬æµ‹è¯• (æ¨è)

1. **å¯åŠ¨æœåŠ¡å™¨**
   ```bash
   cd my-backend
   npm start
   ```

2. **è¿è¡Œå¤šç”¨æˆ·æµ‹è¯•è„šæœ¬**
   ```bash
   node scripts/multi-user-test.js
   ```

   è¿™ä¸ªè„šæœ¬ä¼šï¼š
   - åŒæ—¶è¿æ¥5ä¸ªä¸åŒè§’è‰²çš„ç”¨æˆ·
   - è‡ªåŠ¨å‘é€æ¶ˆæ¯
   - æ¨¡æ‹ŸçœŸå®çš„ç”¨æˆ·äº¤äº’
   - è¾“å‡ºæµ‹è¯•ç»“æœå’Œæ€§èƒ½ç»Ÿè®¡

### æ–¹æ³•2: ä½¿ç”¨Jesté›†æˆæµ‹è¯•

1. **è¿è¡Œç°æœ‰çš„é›†æˆæµ‹è¯•**
   ```bash
   cd my-backend
   npm test
   ```

   è¿™ä¼šè¿è¡Œä»¥ä¸‹æµ‹è¯•ï¼š
   - `tests/integration/textChat.test.js` - æ–‡æœ¬èŠå¤©åŠŸèƒ½æµ‹è¯•
   - `tests/integration/scoring.test.js` - è¯„åˆ†åŠŸèƒ½æµ‹è¯•

### æ–¹æ³•3: æ‰‹åŠ¨æµè§ˆå™¨æµ‹è¯•

1. **å¯åŠ¨æœåŠ¡å™¨**
   ```bash
   cd my-backend
   npm start
   ```

2. **æ‰“å¼€å¤šä¸ªæµè§ˆå™¨çª—å£**
   - è®¿é—® `http://localhost:3000/chat-room.html`
   - åœ¨æ¯ä¸ªçª—å£ä¸­ç™»å½•ä¸åŒçš„ç”¨æˆ·
   - æ‰‹åŠ¨æµ‹è¯•èŠå¤©ã€ä¸¾æ‰‹ç­‰åŠŸèƒ½

## æµ‹è¯•é…ç½®

### ä¿®æ”¹æµ‹è¯•å‚æ•°

ç¼–è¾‘ `scripts/multi-user-test.js` ä¸­çš„é…ç½®ï¼š

```javascript
const config = {
  serverUrl: 'ws://localhost:3000',  // æœåŠ¡å™¨åœ°å€
  roomId: 'test-room',               // æˆ¿é—´ID
  userCount: 5,                      // ç”¨æˆ·æ•°é‡
  testDuration: 30000                // æµ‹è¯•æ—¶é•¿(æ¯«ç§’)
};
```

### ç”¨æˆ·è§’è‰²é…ç½®

```javascript
const users = [
  { username: 'delegate1', role: 'delegate', country: 'ä¸­å›½' },
  { username: 'delegate2', role: 'delegate', country: 'ç¾å›½' },
  { username: 'delegate3', role: 'delegate', country: 'ä¿„ç½—æ–¯' },
  { username: 'judge1', role: 'judge', country: 'è”åˆå›½' },
  { username: 'host1', role: 'host', country: 'è”åˆå›½' }
];
```

## æµ‹è¯•åœºæ™¯

### åŸºç¡€åŠŸèƒ½æµ‹è¯•
- âœ… å¤šç”¨æˆ·åŒæ—¶è¿æ¥
- âœ… ç”¨æˆ·åŠ å…¥/ç¦»å¼€æˆ¿é—´
- âœ… ç¾¤èŠæ¶ˆæ¯å‘é€/æ¥æ”¶
- âœ… ç”¨æˆ·åˆ—è¡¨æ›´æ–°
- âœ… ä¸¾æ‰‹åŠŸèƒ½

### æ€§èƒ½æµ‹è¯•
- âœ… è¿æ¥ç¨³å®šæ€§
- âœ… æ¶ˆæ¯å‘é€æˆåŠŸç‡
- âœ… æ¶ˆæ¯å¤„ç†å»¶è¿Ÿ
- âœ… å†…å­˜ä½¿ç”¨æƒ…å†µ

### å‹åŠ›æµ‹è¯•
- âœ… å¤§é‡ç”¨æˆ·åŒæ—¶è¿æ¥
- âœ… é«˜é¢‘æ¶ˆæ¯å‘é€
- âœ… é•¿æ—¶é—´è¿è¡Œç¨³å®šæ€§

## ç›‘æ§æŒ‡æ ‡

æµ‹è¯•è„šæœ¬ä¼šè¾“å‡ºä»¥ä¸‹æŒ‡æ ‡ï¼š

```
ğŸ“Š æµ‹è¯•ç»“æœ:
â±ï¸  æ—¶é•¿: 30000ms
ğŸ’¬ æ¶ˆæ¯æ•°: 45
ğŸ“ˆ æ¶ˆæ¯ç‡: 1.5 æ¶ˆæ¯/ç§’
```

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **è¿æ¥å¤±è´¥**
   - ç¡®ä¿æœåŠ¡å™¨æ­£åœ¨è¿è¡Œ
   - æ£€æŸ¥ç«¯å£3000æ˜¯å¦è¢«å ç”¨
   - éªŒè¯WebSocket URLæ˜¯å¦æ­£ç¡®

2. **è®¤è¯å¤±è´¥**
   - æ£€æŸ¥JWTå¯†é’¥é…ç½®
   - ç¡®ä¿ç”¨æˆ·è§’è‰²é…ç½®æ­£ç¡®

3. **æ¶ˆæ¯å‘é€å¤±è´¥**
   - æ£€æŸ¥ç½‘ç»œè¿æ¥
   - éªŒè¯æˆ¿é—´IDæ˜¯å¦æ­£ç¡®
   - æŸ¥çœ‹æœåŠ¡å™¨æ—¥å¿—

### è°ƒè¯•æŠ€å·§

1. **æŸ¥çœ‹æœåŠ¡å™¨æ—¥å¿—**
   ```bash
   cd my-backend
   npm start
   ```

2. **ä½¿ç”¨æµè§ˆå™¨å¼€å‘è€…å·¥å…·**
   - æ‰“å¼€Networkæ ‡ç­¾é¡µ
   - æŸ¥çœ‹WebSocketè¿æ¥çŠ¶æ€
   - æ£€æŸ¥æ§åˆ¶å°é”™è¯¯

3. **ä¿®æ”¹æ—¥å¿—çº§åˆ«**
   åœ¨ `app.js` ä¸­æ·»åŠ æ›´å¤šæ—¥å¿—è¾“å‡º

## æ‰©å±•æµ‹è¯•

### æ·»åŠ æ–°çš„æµ‹è¯•åœºæ™¯

1. **éŸ³é¢‘èŠå¤©æµ‹è¯•**
   ```javascript
   // åœ¨multi-user-test.jsä¸­æ·»åŠ éŸ³é¢‘æµ‹è¯•
   ws.send(audioData, { binary: true });
   ```

2. **ç§èŠæµ‹è¯•**
   ```javascript
   ws.send(JSON.stringify({
     type: 'private',
     to: targetUserId,
     content: 'ç§èŠæ¶ˆæ¯'
   }));
   ```

3. **æƒé™æµ‹è¯•**
   ```javascript
   // æµ‹è¯•ä¸åŒè§’è‰²çš„æƒé™
   ws.send(JSON.stringify({
     type: 'updateUserStatus',
     targetUserId: 'user1',
     action: 'toggleSpeak'
   }));
   ```

### æ€§èƒ½åŸºå‡†

å»ºè®®çš„æ€§èƒ½æŒ‡æ ‡ï¼š
- è¿æ¥æˆåŠŸç‡: > 99%
- æ¶ˆæ¯å‘é€æˆåŠŸç‡: > 99%
- å¹³å‡å“åº”æ—¶é—´: < 100ms
- æ”¯æŒå¹¶å‘ç”¨æˆ·æ•°: > 100

## è‡ªåŠ¨åŒ–æµ‹è¯•

### é›†æˆåˆ°CI/CD

åœ¨ `package.json` ä¸­æ·»åŠ æµ‹è¯•è„šæœ¬ï¼š

```json
{
  "scripts": {
    "test:multi-user": "node scripts/multi-user-test.js",
    "test:all": "npm test && npm run test:multi-user"
  }
}
```

### å®šæ—¶æµ‹è¯•

ä½¿ç”¨cronä»»åŠ¡å®šæœŸè¿è¡Œæµ‹è¯•ï¼š

```bash
# æ¯å°æ—¶è¿è¡Œä¸€æ¬¡å¤šç”¨æˆ·æµ‹è¯•
0 * * * * cd /path/to/my-backend && node scripts/multi-user-test.js
```

## æ€»ç»“

å¤šç”¨æˆ·æµ‹è¯•æ˜¯éªŒè¯ç³»ç»Ÿç¨³å®šæ€§å’Œæ€§èƒ½çš„é‡è¦ç¯èŠ‚ã€‚é€šè¿‡ä»¥ä¸Šæ–¹æ³•ï¼Œä½ å¯ä»¥ï¼š

1. å¿«é€ŸéªŒè¯åŸºæœ¬åŠŸèƒ½
2. å‘ç°å¹¶å‘é—®é¢˜
3. è¯„ä¼°ç³»ç»Ÿæ€§èƒ½
4. ç¡®ä¿ç”Ÿäº§ç¯å¢ƒç¨³å®šæ€§

å»ºè®®åœ¨æ¯æ¬¡é‡è¦æ›´æ–°åéƒ½è¿è¡Œå¤šç”¨æˆ·æµ‹è¯•ï¼Œç¡®ä¿ç³»ç»Ÿè´¨é‡ã€‚ 