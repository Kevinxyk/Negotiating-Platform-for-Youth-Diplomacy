# å¤šç”¨æˆ·æµ‹è¯•å¿«é€Ÿå¼€å§‹æŒ‡å—

## ğŸš€ å¿«é€Ÿå¼€å§‹ (5åˆ†é’Ÿ)

### 1. å¯åŠ¨æœåŠ¡å™¨
```bash
cd my-backend
npm start
```

### 2. è¿è¡Œå¤šç”¨æˆ·æµ‹è¯•
```bash
# æ–¹æ³•1: ä½¿ç”¨npmè„šæœ¬
npm run test:multi-user

# æ–¹æ³•2: ç›´æ¥è¿è¡Œè„šæœ¬
node scripts/multi-user-test.js

# æ–¹æ³•3: ä½¿ç”¨å¯åŠ¨è„šæœ¬ (Windows)
run-multi-user-test.bat

# æ–¹æ³•3: ä½¿ç”¨å¯åŠ¨è„šæœ¬ (PowerShell)
powershell -ExecutionPolicy Bypass -File run-multi-user-test.ps1
```

### 3. æŸ¥çœ‹ç»“æœ
æµ‹è¯•å®Œæˆåä¼šæ˜¾ç¤ºè¯¦ç»†çš„æ€§èƒ½æŠ¥å‘Šï¼ŒåŒ…æ‹¬ï¼š
- è¿æ¥æˆåŠŸç‡
- æ¶ˆæ¯å‘é€æˆåŠŸç‡
- å“åº”æ—¶é—´ç»Ÿè®¡
- æ€§èƒ½åŸºå‡†æ£€æŸ¥

## ğŸ“Š æµ‹è¯•é…ç½®

### ä¿®æ”¹æµ‹è¯•å‚æ•°
ç¼–è¾‘ `scripts/test-config.js` æ–‡ä»¶ï¼š

```javascript
// ä¿®æ”¹ç”¨æˆ·æ•°é‡
test: {
  userCount: 10,  // æ”¹ä¸º10ä¸ªç”¨æˆ·
  testDuration: 60000,  // æ”¹ä¸º60ç§’
  messageInterval: 2000  // æ”¹ä¸º2ç§’å‘é€ä¸€æ¬¡
}
```

### å¸¸ç”¨é…ç½®ç»„åˆ

**è½»é‡æµ‹è¯• (å¿«é€ŸéªŒè¯)**
```javascript
test: {
  userCount: 3,
  testDuration: 15000,
  messageInterval: 2000
}
```

**æ ‡å‡†æµ‹è¯• (æ¨è)**
```javascript
test: {
  userCount: 5,
  testDuration: 30000,
  messageInterval: 3000
}
```

**å‹åŠ›æµ‹è¯• (æ€§èƒ½éªŒè¯)**
```javascript
test: {
  userCount: 20,
  testDuration: 60000,
  messageInterval: 1000
}
```

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

**1. è¿æ¥å¤±è´¥**
```
âŒ delegate1 è¿æ¥é”™è¯¯: connect ECONNREFUSED 127.0.0.1:3000
```
**è§£å†³æ–¹æ¡ˆ**: ç¡®ä¿æœåŠ¡å™¨æ­£åœ¨è¿è¡Œ `npm start`

**2. è®¤è¯å¤±è´¥**
```
âŒ delegate1 æ¶ˆæ¯è§£æé”™è¯¯: jwt malformed
```
**è§£å†³æ–¹æ¡ˆ**: æ£€æŸ¥JWTå¯†é’¥é…ç½®æ˜¯å¦æ­£ç¡®

**3. ç«¯å£è¢«å ç”¨**
```
âŒ delegate1 è¿æ¥é”™è¯¯: connect ECONNREFUSED 127.0.0.1:3000
```
**è§£å†³æ–¹æ¡ˆ**: ä¿®æ”¹ `test-config.js` ä¸­çš„ç«¯å£å·

### è°ƒè¯•æ¨¡å¼

å¯ç”¨è¯¦ç»†æ—¥å¿—ï¼š
```javascript
logging: {
  level: 'debug',  // æ”¹ä¸ºdebugçº§åˆ«
  showTimestamps: true,
  showUserDetails: true
}
```

## ğŸ“ˆ æ€§èƒ½åŸºå‡†

æµ‹è¯•è„šæœ¬ä¼šè‡ªåŠ¨æ£€æŸ¥ä»¥ä¸‹æ€§èƒ½æŒ‡æ ‡ï¼š

| æŒ‡æ ‡ | ç›®æ ‡å€¼ | è¯´æ˜ |
|------|--------|------|
| è¿æ¥æˆåŠŸç‡ | â‰¥99% | ç”¨æˆ·è¿æ¥æˆåŠŸç‡ |
| æ¶ˆæ¯æˆåŠŸç‡ | â‰¥99% | æ¶ˆæ¯å‘é€æˆåŠŸç‡ |
| å“åº”æ—¶é—´ | â‰¤100ms | å¹³å‡å“åº”æ—¶é—´ |
| å¹¶å‘ç”¨æˆ· | â‰¥100 | æ”¯æŒçš„æœ€å¤§å¹¶å‘ç”¨æˆ·æ•° |

## ğŸ¯ æµ‹è¯•åœºæ™¯

### åŸºç¡€åŠŸèƒ½æµ‹è¯•
- âœ… å¤šç”¨æˆ·åŒæ—¶è¿æ¥
- âœ… ç”¨æˆ·åŠ å…¥/ç¦»å¼€æˆ¿é—´
- âœ… ç¾¤èŠæ¶ˆæ¯å‘é€/æ¥æ”¶
- âœ… ç”¨æˆ·åˆ—è¡¨æ›´æ–°
- âœ… ä¸¾æ‰‹åŠŸèƒ½

### æ€§èƒ½æµ‹è¯•
- âœ… è¿æ¥ç¨³å®šæ€§
- âœ… æ¶ˆæ¯å‘é€æˆåŠŸç‡
- âœ… æ¶ˆæ¯å¤„ç†å»¶è¿Ÿ
- âœ… å†…å­˜ä½¿ç”¨æƒ…å†µ

### å‹åŠ›æµ‹è¯•
- âœ… å¤§é‡ç”¨æˆ·åŒæ—¶è¿æ¥
- âœ… é«˜é¢‘æ¶ˆæ¯å‘é€
- âœ… é•¿æ—¶é—´è¿è¡Œç¨³å®šæ€§

## ğŸ”„ è‡ªåŠ¨åŒ–æµ‹è¯•

### é›†æˆåˆ°CI/CD
```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
npm run test:all

# åªè¿è¡Œå¤šç”¨æˆ·æµ‹è¯•
npm run test:multi-user
```

### å®šæ—¶æµ‹è¯•
```bash
# æ¯å°æ—¶è¿è¡Œä¸€æ¬¡æµ‹è¯•
0 * * * * cd /path/to/my-backend && npm run test:multi-user
```

## ğŸ“ è‡ªå®šä¹‰æµ‹è¯•

### æ·»åŠ æ–°çš„æµ‹è¯•æ¶ˆæ¯
ç¼–è¾‘ `test-config.js` ä¸­çš„ `messages` æ•°ç»„ï¼š

```javascript
messages: [
  'å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯{country}çš„ä»£è¡¨{username}',
  'æˆ‘è®¤ä¸ºæˆ‘ä»¬åº”è¯¥è®¨è®ºè¿™ä¸ªé‡è¦è®®é¢˜',
  // æ·»åŠ ä½ çš„è‡ªå®šä¹‰æ¶ˆæ¯...
  'è¿™æ˜¯ä¸€ä¸ªæ–°çš„æµ‹è¯•æ¶ˆæ¯'
]
```

### æ·»åŠ æ–°çš„ç”¨æˆ·è§’è‰²
```javascript
users: [
  // ç°æœ‰ç”¨æˆ·...
  { username: 'newuser', role: 'delegate', country: 'æ–°å›½å®¶' }
]
```

### è‡ªå®šä¹‰æ€§èƒ½åŸºå‡†
```javascript
benchmarks: {
  minConnectionSuccessRate: 0.95,  // é™ä½è¦æ±‚åˆ°95%
  minMessageSuccessRate: 0.98,     // é™ä½è¦æ±‚åˆ°98%
  maxResponseTime: 200,            // æ”¾å®½åˆ°200ms
}
```

## ğŸ‰ æˆåŠŸæ ‡å¿—

å½“çœ‹åˆ°ä»¥ä¸‹è¾“å‡ºæ—¶ï¼Œè¯´æ˜æµ‹è¯•æˆåŠŸï¼š

```
ğŸ¯ æ€§èƒ½åŸºå‡†æ£€æŸ¥:
ğŸ”— è¿æ¥æˆåŠŸç‡: âœ… 100.0% (ç›®æ ‡: 99.0%)
ğŸ’¬ æ¶ˆæ¯æˆåŠŸç‡: âœ… 100.0% (ç›®æ ‡: 99.0%)
âš¡ å“åº”æ—¶é—´: âœ… 45.2ms (ç›®æ ‡: â‰¤100ms)

ğŸ‰ æ‰€æœ‰åŸºå‡†æµ‹è¯•é€šè¿‡ï¼
```

## ğŸ“ è·å–å¸®åŠ©

å¦‚æœé‡åˆ°é—®é¢˜ï¼š

1. æŸ¥çœ‹ `MULTI_USER_TEST_README.md` è·å–è¯¦ç»†æ–‡æ¡£
2. æ£€æŸ¥æœåŠ¡å™¨æ—¥å¿— `npm start`
3. å¯ç”¨è°ƒè¯•æ¨¡å¼æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
4. ç¡®ä¿æ‰€æœ‰ä¾èµ–å·²æ­£ç¡®å®‰è£… `npm install`

---

**æç¤º**: å»ºè®®åœ¨æ¯æ¬¡é‡è¦æ›´æ–°åéƒ½è¿è¡Œå¤šç”¨æˆ·æµ‹è¯•ï¼Œç¡®ä¿ç³»ç»Ÿç¨³å®šæ€§ã€‚ 